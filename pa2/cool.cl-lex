3
class
3
type
Node
3
inherits
3
type
Nil
3
lbrace
5
identifier
label
5
colon
5
type
String
5
semi
6
identifier
inDeg
6
colon
6
type
Int
6
semi
7
identifier
outList
7
colon
7
type
List
7
semi
9
identifier
init
9
lparen
9
identifier
newLabel
9
colon
9
type
String
9
rparen
9
colon
9
type
Node
9
lbrace
10
lbrace
11
identifier
label
11
larrow
11
identifier
newLabel
11
semi
12
identifier
inDeg
12
larrow
12
integer
0
12
semi
13
identifier
outList
13
larrow
13
new
13
type
Nil
13
semi
14
identifier
self
14
semi
15
rbrace
16
rbrace
16
semi
18
identifier
get_label
18
lparen
18
rparen
18
colon
18
type
String
18
lbrace
18
identifier
label
18
rbrace
18
semi
19
identifier
get_inDeg
19
lparen
19
rparen
19
colon
19
type
Int
19
lbrace
19
identifier
inDeg
19
rbrace
19
semi
20
identifier
set_inDeg
20
lparen
20
identifier
deg
20
colon
20
type
Int
20
rparen
20
colon
20
type
Int
20
lbrace
20
identifier
inDeg
20
larrow
20
identifier
deg
20
rbrace
20
semi
21
identifier
get_outList
21
lparen
21
rparen
21
colon
21
type
List
21
lbrace
21
identifier
outList
21
rbrace
21
semi
22
identifier
set_outList
22
lparen
22
identifier
l
22
colon
22
type
List
22
rparen
22
colon
22
type
List
22
lbrace
22
identifier
outList
22
larrow
22
identifier
l
22
rbrace
22
semi
24
rbrace
24
semi
26
class
26
type
Util
26
lbrace
28
identifier
getInstance
28
lparen
28
identifier
label
28
colon
28
type
String
28
comma
28
identifier
graph
28
colon
28
type
List
28
rparen
28
colon
28
type
Node
28
lbrace
29
let
30
identifier
iter
30
colon
30
type
Iterator
30
larrow
30
lparen
30
new
30
type
Iterator
30
rparen
30
dot
30
identifier
init
30
lparen
30
identifier
graph
30
rparen
30
comma
31
identifier
curr_Node
31
colon
31
type
Node
31
larrow
31
identifier
iter
31
dot
31
identifier
step
31
lparen
31
rparen
31
comma
32
identifier
instance
32
colon
32
type
Node
33
in
33
lbrace
34
while
34
not
34
isvoid
34
identifier
curr_Node
34
loop
34
lbrace
36
if
36
identifier
curr_Node
36
dot
36
identifier
get_label
36
lparen
36
rparen
36
equals
36
identifier
label
36
then
37
identifier
instance
37
larrow
37
identifier
curr_Node
38
else
38
true
38
fi
38
semi
40
identifier
curr_Node
40
larrow
40
identifier
iter
40
dot
40
identifier
step
40
lparen
40
rparen
40
semi
42
rbrace
42
pool
42
semi
43
identifier
instance
43
semi
44
rbrace
45
rbrace
45
semi
47
identifier
topo
47
lparen
47
identifier
graph
47
colon
47
type
List
47
comma
47
identifier
nEdges
47
colon
47
type
Int
47
rparen
47
colon
47
type
List
47
lbrace
49
let
50
identifier
s
50
colon
50
type
List
50
larrow
50
new
50
type
Nil
50
comma
51
identifier
l
51
colon
51
type
List
51
larrow
51
new
51
type
Nil
52
in
52
lbrace
54
let
55
identifier
g_iter
55
colon
55
type
Iterator
55
larrow
55
lparen
55
new
55
type
Iterator
55
rparen
55
dot
55
identifier
init
55
lparen
55
identifier
graph
55
rparen
55
comma
56
identifier
curr_Node
56
colon
56
type
Node
56
larrow
56
identifier
g_iter
56
dot
56
identifier
step
56
lparen
56
rparen
57
in
57
lbrace
58
while
58
not
58
isvoid
58
identifier
curr_Node
58
loop
58
lbrace
60
if
60
identifier
curr_Node
60
dot
60
identifier
get_inDeg
60
lparen
60
rparen
60
equals
60
integer
0
60
then
61
identifier
s
61
larrow
61
identifier
s
61
dot
61
identifier
insert
61
lparen
61
identifier
curr_Node
61
rparen
62
else
62
true
62
fi
62
semi
64
identifier
curr_Node
64
larrow
64
identifier
g_iter
64
dot
64
identifier
step
64
lparen
64
rparen
64
semi
66
rbrace
66
pool
66
semi
67
rbrace
67
semi
69
let
70
identifier
n
70
colon
70
type
Node
70
larrow
70
identifier
s
70
dot
70
identifier
pop
70
lparen
70
rparen
71
in
71
lbrace
72
while
72
not
72
isvoid
72
identifier
n
72
loop
72
lbrace
73
identifier
l
73
larrow
73
identifier
l
73
dot
73
identifier
push
73
lparen
73
identifier
n
73
rparen
73
semi
75
let
76
identifier
out_iter
76
colon
76
type
Iterator
76
larrow
76
lparen
76
new
76
type
Iterator
76
rparen
76
dot
76
identifier
init
76
lparen
76
identifier
n
76
dot
76
identifier
get_outList
76
lparen
76
rparen
76
rparen
76
comma
77
identifier
curr_Node
77
colon
77
type
Node
77
larrow
77
identifier
out_iter
77
dot
77
identifier
step
77
lparen
77
rparen
78
in
78
lbrace
79
while
79
not
79
isvoid
79
identifier
curr_Node
79
loop
79
lbrace
80
identifier
curr_Node
80
dot
80
identifier
set_inDeg
80
lparen
80
identifier
curr_Node
80
dot
80
identifier
get_inDeg
80
lparen
80
rparen
80
minus
80
integer
1
80
rparen
80
semi
81
identifier
nEdges
81
larrow
81
identifier
nEdges
81
minus
81
integer
1
81
semi
83
if
83
identifier
curr_Node
83
dot
83
identifier
get_inDeg
83
lparen
83
rparen
83
equals
83
integer
0
83
then
84
identifier
s
84
larrow
84
identifier
s
84
dot
84
identifier
insert
84
lparen
84
identifier
curr_Node
84
rparen
85
else
85
true
85
fi
85
semi
87
identifier
curr_Node
87
larrow
87
identifier
out_iter
87
dot
87
identifier
step
87
lparen
87
rparen
87
semi
88
rbrace
88
pool
88
semi
89
rbrace
89
semi
90
identifier
n
90
larrow
90
identifier
s
90
dot
90
identifier
pop
90
lparen
90
rparen
90
semi
91
rbrace
91
pool
91
semi
92
rbrace
92
semi
94
if
94
not
94
lparen
94
identifier
nEdges
94
equals
94
integer
0
94
rparen
94
then
95
let
95
identifier
void
95
colon
95
type
List
95
in
95
lbrace
95
identifier
void
95
semi
95
rbrace
96
else
97
identifier
l
98
fi
98
semi
99
rbrace
100
rbrace
100
semi
101
rbrace
101
semi
104
class
104
type
Main
104
inherits
104
type
IO
104
lbrace
106
identifier
main
106
lparen
106
rparen
106
colon
106
type
Object
106
lbrace
107
let
108
identifier
u
108
colon
108
type
Util
108
larrow
108
new
108
type
Util
108
comma
109
identifier
graph
109
colon
109
type
List
109
larrow
109
new
109
type
Nil
109
comma
110
identifier
done
110
colon
110
type
Bool
110
larrow
110
false
110
comma
111
identifier
nEdges
111
colon
111
type
Int
111
larrow
111
integer
0
111
comma
112
identifier
l
112
colon
112
type
List
113
in
113
lbrace
114
while
114
not
114
identifier
done
114
loop
114
lbrace
116
let
117
identifier
child
117
colon
117
type
String
117
larrow
117
identifier
in_string
117
lparen
117
rparen
117
comma
118
identifier
parent
118
colon
118
type
String
118
larrow
118
identifier
in_string
118
lparen
118
rparen
118
comma
119
identifier
child_inst
119
colon
119
type
Node
119
comma
120
identifier
parent_inst
120
colon
120
type
Node
121
in
121
lbrace
122
if
122
identifier
child
122
equals
122
string

122
then
123
identifier
done
123
larrow
123
true
124
else
124
lbrace
126
identifier
child_inst
126
larrow
126
identifier
u
126
dot
126
identifier
getInstance
126
lparen
126
identifier
child
126
comma
126
identifier
graph
126
rparen
126
semi
127
if
127
isvoid
127
identifier
child_inst
127
then
127
lbrace
128
identifier
child_inst
128
larrow
128
lparen
128
new
128
type
Node
128
rparen
128
dot
128
identifier
init
128
lparen
128
identifier
child
128
rparen
128
semi
129
identifier
graph
129
larrow
129
identifier
graph
129
dot
129
identifier
push
129
lparen
129
identifier
child_inst
129
rparen
129
semi
130
rbrace
131
else
131
true
131
fi
131
semi
133
identifier
parent_inst
133
larrow
133
identifier
u
133
dot
133
identifier
getInstance
133
lparen
133
identifier
parent
133
comma
133
identifier
graph
133
rparen
133
semi
134
if
134
isvoid
134
identifier
parent_inst
134
then
134
lbrace
135
identifier
parent_inst
135
larrow
135
lparen
135
new
135
type
Node
135
rparen
135
dot
135
identifier
init
135
lparen
135
identifier
parent
135
rparen
135
semi
136
identifier
graph
136
larrow
136
identifier
graph
136
dot
136
identifier
push
136
lparen
136
identifier
parent_inst
136
rparen
136
semi
137
rbrace
138
else
138
true
138
fi
138
semi
140
identifier
parent_inst
140
dot
140
identifier
set_outList
140
lparen
140
identifier
parent_inst
140
dot
140
identifier
get_outList
140
lparen
140
rparen
140
dot
140
identifier
push
140
lparen
140
identifier
child_inst
140
rparen
140
rparen
140
semi
141
identifier
child_inst
141
dot
141
identifier
set_inDeg
141
lparen
141
identifier
child_inst
141
dot
141
identifier
get_inDeg
141
lparen
141
rparen
141
plus
141
integer
1
141
rparen
141
semi
142
identifier
nEdges
142
larrow
142
identifier
nEdges
142
plus
142
integer
1
142
semi
144
rbrace
145
fi
145
semi
146
rbrace
146
semi
147
rbrace
147
pool
147
semi
149
identifier
l
149
larrow
149
identifier
u
149
dot
149
identifier
topo
149
lparen
149
identifier
graph
149
comma
149
identifier
nEdges
149
rparen
149
semi
151
if
151
isvoid
151
identifier
l
151
then
152
identifier
out_string
152
lparen
152
string
cycle\n
152
rparen
153
else
154
identifier
l
154
dot
154
identifier
print_list
154
lparen
154
rparen
155
fi
155
semi
156
rbrace
157
rbrace
157
semi
158
rbrace
158
semi
161
class
161
type
List
161
inherits
161
type
IO
161
lbrace
163
identifier
insert
163
lparen
163
identifier
i
163
colon
163
type
Node
163
rparen
163
colon
163
type
List
163
lbrace
163
identifier
self
163
rbrace
163
semi
164
identifier
push
164
lparen
164
identifier
i
164
colon
164
type
Node
164
rparen
164
colon
164
type
List
164
lbrace
164
identifier
self
164
rbrace
164
semi
165
identifier
pop
165
lparen
165
rparen
165
colon
165
type
Node
165
lbrace
165
let
165
identifier
void
165
colon
165
type
Node
165
in
165
lbrace
165
identifier
void
165
semi
165
rbrace
165
rbrace
165
semi
166
identifier
get_hd
166
lparen
166
rparen
166
colon
166
type
Node
166
lbrace
166
let
166
identifier
void
166
colon
166
type
Node
166
in
166
lbrace
166
identifier
void
166
semi
166
rbrace
166
rbrace
166
semi
167
identifier
get_tl
167
lparen
167
rparen
167
colon
167
type
List
167
lbrace
167
let
167
identifier
void
167
colon
167
type
List
167
in
167
lbrace
167
identifier
void
167
semi
167
rbrace
167
rbrace
167
semi
168
identifier
print_list
168
lparen
168
rparen
168
colon
168
type
Object
168
lbrace
168
identifier
abort
168
lparen
168
rparen
168
rbrace
168
semi
170
rbrace
170
semi
172
class
172
type
Cons
172
inherits
172
type
List
172
lbrace
174
identifier
hd
174
colon
174
type
Node
174
semi
175
identifier
tl
175
colon
175
type
List
175
semi
177
identifier
init
177
lparen
177
identifier
new_hd
177
colon
177
type
Node
177
comma
177
identifier
new_tl
177
colon
177
type
List
177
rparen
177
colon
177
type
Cons
177
lbrace
178
lbrace
179
identifier
hd
179
larrow
179
identifier
new_hd
179
semi
180
identifier
tl
180
larrow
180
identifier
new_tl
180
semi
181
identifier
self
181
semi
182
rbrace
183
rbrace
183
semi
185
identifier
insert
185
lparen
185
identifier
n
185
colon
185
type
Node
185
rparen
185
colon
185
type
List
185
lbrace
187
if
187
isvoid
187
identifier
hd
187
then
188
lparen
188
new
188
type
Nil
188
rparen
188
dot
188
identifier
insert
188
lparen
188
identifier
n
188
rparen
189
else
190
if
190
lparen
190
identifier
n
190
dot
190
identifier
get_label
190
lparen
190
rparen
190
lt
190
identifier
hd
190
dot
190
identifier
get_label
190
lparen
190
rparen
190
rparen
190
then
191
lparen
191
new
191
type
Cons
191
rparen
191
dot
191
identifier
init
191
lparen
191
identifier
n
191
comma
191
identifier
self
191
rparen
192
else
193
lparen
193
new
193
type
Cons
193
rparen
193
dot
193
identifier
init
193
lparen
193
identifier
hd
193
comma
193
identifier
tl
193
dot
193
identifier
insert
193
lparen
193
identifier
n
193
rparen
193
rparen
194
fi
195
fi
196
rbrace
196
semi
198
identifier
pop
198
lparen
198
rparen
198
colon
198
type
Node
198
lbrace
199
let
199
identifier
return
199
colon
199
type
Node
199
larrow
199
identifier
hd
200
in
200
lbrace
201
if
201
not
201
isvoid
201
identifier
return
201
then
201
lbrace
202
identifier
hd
202
larrow
202
identifier
tl
202
dot
202
identifier
get_hd
202
lparen
202
rparen
202
semi
203
identifier
tl
203
larrow
203
identifier
tl
203
dot
203
identifier
get_tl
203
lparen
203
rparen
203
semi
204
rbrace
205
else
205
true
205
fi
205
semi
206
identifier
return
206
semi
207
rbrace
208
rbrace
208
semi
210
identifier
push
210
lparen
210
identifier
n
210
colon
210
type
Node
210
rparen
210
colon
210
type
List
210
lbrace
211
if
211
isvoid
211
identifier
hd
211
then
212
lparen
212
new
212
type
Nil
212
rparen
212
dot
212
identifier
insert
212
lparen
212
identifier
n
212
rparen
213
else
214
if
214
isvoid
214
identifier
tl
214
dot
214
identifier
get_hd
214
lparen
214
rparen
214
then
215
lparen
215
new
215
type
Cons
215
rparen
215
dot
215
identifier
init
215
lparen
215
identifier
hd
215
comma
215
lparen
215
new
215
type
Nil
215
rparen
215
dot
215
identifier
push
215
lparen
215
identifier
n
215
rparen
215
rparen
216
else
217
lparen
217
new
217
type
Cons
217
rparen
217
dot
217
identifier
init
217
lparen
217
identifier
hd
217
comma
217
identifier
tl
217
dot
217
identifier
push
217
lparen
217
identifier
n
217
rparen
217
rparen
218
fi
219
fi
220
rbrace
220
semi
222
identifier
print_list
222
lparen
222
rparen
222
colon
222
type
Object
222
lbrace
223
lbrace
224
identifier
out_string
224
lparen
224
identifier
hd
224
dot
224
identifier
get_label
224
lparen
224
rparen
224
rparen
224
semi
225
identifier
out_string
225
lparen
225
string
\n
225
rparen
225
semi
226
identifier
tl
226
dot
226
identifier
print_list
226
lparen
226
rparen
226
semi
227
rbrace
228
rbrace
228
semi
230
identifier
get_hd
230
lparen
230
rparen
230
colon
230
type
Node
230
lbrace
230
identifier
hd
230
rbrace
230
semi
231
identifier
get_tl
231
lparen
231
rparen
231
colon
231
type
List
231
lbrace
231
identifier
tl
231
rbrace
231
semi
233
rbrace
233
semi
235
class
235
type
Nil
235
inherits
235
type
List
235
lbrace
236
identifier
insert
236
lparen
236
identifier
n
236
colon
236
type
Node
236
rparen
236
colon
236
type
List
236
lbrace
236
lparen
236
new
236
type
Cons
236
rparen
236
dot
236
identifier
init
236
lparen
236
identifier
n
236
comma
236
identifier
self
236
rparen
236
rbrace
236
semi
237
identifier
push
237
lparen
237
identifier
n
237
colon
237
type
Node
237
rparen
237
colon
237
type
List
237
lbrace
237
identifier
insert
237
lparen
237
identifier
n
237
rparen
237
rbrace
237
semi
238
identifier
print_list
238
lparen
238
rparen
238
colon
238
type
Object
238
lbrace
238
true
238
rbrace
238
semi
239
rbrace
239
semi
241
class
241
type
Iterator
241
lbrace
243
identifier
list
243
colon
243
type
List
243
semi
244
identifier
hd
244
colon
244
type
Node
244
semi
246
identifier
init
246
lparen
246
identifier
newList
246
colon
246
type
List
246
rparen
246
colon
246
type
Iterator
246
lbrace
247
lbrace
248
identifier
list
248
larrow
248
identifier
newList
248
semi
249
identifier
hd
249
larrow
249
identifier
newList
249
dot
249
identifier
get_hd
249
lparen
249
rparen
249
semi
250
identifier
self
250
semi
251
rbrace
252
rbrace
252
semi
254
identifier
step
254
lparen
254
rparen
254
colon
254
type
Node
254
lbrace
255
let
255
identifier
return
255
colon
255
type
Node
256
in
256
lbrace
257
if
257
not
257
isvoid
257
identifier
hd
257
then
258
lbrace
259
identifier
return
259
larrow
259
identifier
hd
259
semi
260
identifier
list
260
larrow
260
identifier
list
260
dot
260
identifier
get_tl
260
lparen
260
rparen
260
semi
261
identifier
hd
261
larrow
261
identifier
list
261
dot
261
identifier
get_hd
261
lparen
261
rparen
261
semi
262
rbrace
263
else
263
true
263
fi
263
semi
264
identifier
return
264
semi
265
rbrace
266
rbrace
266
semi
268
rbrace
268
semi
