4
type
Class
4
type
Node
4
inherits
4
type
Nil
4
lbrace
8
identifier
label
8
colon
8
type
String
8
semi
10
identifier
inDeg
10
colon
10
type
Int
10
semi
12
identifier
outList
12
colon
12
type
List
12
semi
16
identifier
init
16
lparen
16
identifier
newLabel
16
colon
16
type
String
16
rparen
16
colon
16
type
Node
16
lbrace
18
lbrace
20
identifier
label
20
larrow
20
identifier
newLabel
20
semi
22
identifier
inDeg
22
larrow
22
integer
0
22
semi
24
identifier
outList
24
larrow
24
new
24
type
Nil
24
semi
26
identifier
self
26
semi
28
rbrace
30
rbrace
30
semi
34
identifier
get_label
34
lparen
34
rparen
34
colon
34
type
String
34
lbrace
34
identifier
label
34
rbrace
34
semi
36
identifier
get_inDeg
36
lparen
36
rparen
36
colon
36
type
Int
36
lbrace
36
identifier
inDeg
36
rbrace
36
semi
38
identifier
set_inDeg
38
lparen
38
identifier
deg
38
colon
38
type
Int
38
rparen
38
colon
38
type
Int
38
lbrace
38
identifier
inDeg
38
larrow
38
identifier
deg
38
rbrace
38
semi
40
identifier
get_outList
40
lparen
40
rparen
40
colon
40
type
List
40
lbrace
40
identifier
outList
40
rbrace
40
semi
42
identifier
set_outList
42
lparen
42
identifier
l
42
colon
42
type
List
42
rparen
42
colon
42
type
List
42
lbrace
42
identifier
outList
42
larrow
42
identifier
l
42
rbrace
42
semi
46
rbrace
46
semi
50
type
Class
50
type
Util
50
lbrace
54
identifier
getInstance
54
lparen
54
identifier
label
54
colon
54
type
String
54
comma
54
identifier
graph
54
colon
54
type
List
54
rparen
54
colon
54
type
Node
54
lbrace
56
let
58
identifier
iter
58
colon
58
type
Iterator
58
larrow
58
lparen
58
new
58
type
Iterator
58
rparen
58
dot
58
identifier
init
58
lparen
58
identifier
graph
58
rparen
58
comma
60
identifier
curr_Node
60
colon
60
type
Node
60
larrow
60
identifier
iter
60
dot
60
identifier
step
60
lparen
60
rparen
60
comma
62
identifier
instance
62
colon
62
type
Node
64
in
64
lbrace
66
while
66
not
66
isvoid
66
identifier
curr_Node
66
loop
66
lbrace
70
if
70
identifier
curr_Node
70
dot
70
identifier
get_label
70
lparen
70
rparen
70
equals
70
identifier
label
70
then
72
identifier
instance
72
larrow
72
identifier
curr_Node
74
else
74
true
74
fi
74
semi
78
identifier
curr_Node
78
larrow
78
identifier
iter
78
dot
78
identifier
step
78
lparen
78
rparen
78
semi
82
rbrace
82
pool
82
semi
84
identifier
instance
84
semi
86
rbrace
88
rbrace
88
semi
92
identifier
topo
92
lparen
92
identifier
graph
92
colon
92
type
List
92
comma
92
identifier
nEdges
92
colon
92
type
Int
92
rparen
92
colon
92
type
List
92
lbrace
96
let
98
identifier
s
98
colon
98
type
List
98
larrow
98
new
98
type
Nil
98
comma
100
identifier
l
100
colon
100
type
List
100
larrow
100
new
100
type
Nil
102
in
102
lbrace
106
let
108
identifier
g_iter
108
colon
108
type
Iterator
108
larrow
108
lparen
108
new
108
type
Iterator
108
rparen
108
dot
108
identifier
init
108
lparen
108
identifier
graph
108
rparen
108
comma
110
identifier
curr_Node
110
colon
110
type
Node
110
larrow
110
identifier
g_iter
110
dot
110
identifier
step
110
lparen
110
rparen
112
in
112
lbrace
114
while
114
not
114
isvoid
114
identifier
curr_Node
114
loop
114
lbrace
118
if
118
identifier
curr_Node
118
dot
118
identifier
get_inDeg
118
lparen
118
rparen
118
equals
118
integer
0
118
then
120
identifier
s
120
larrow
120
identifier
s
120
dot
120
identifier
insert
120
lparen
120
identifier
curr_Node
120
rparen
122
else
122
true
122
fi
122
semi
126
identifier
curr_Node
126
larrow
126
identifier
g_iter
126
dot
126
identifier
step
126
lparen
126
rparen
126
semi
130
rbrace
130
pool
130
semi
132
rbrace
132
semi
136
let
138
identifier
n
138
colon
138
type
Node
138
larrow
138
identifier
s
138
dot
138
identifier
pop
138
lparen
138
rparen
140
in
140
lbrace
142
while
142
not
142
isvoid
142
identifier
n
142
loop
142
lbrace
144
identifier
l
144
larrow
144
identifier
l
144
dot
144
identifier
push
144
lparen
144
identifier
n
144
rparen
144
semi
148
let
150
identifier
out_iter
150
colon
150
type
Iterator
150
larrow
150
lparen
150
new
150
type
Iterator
150
rparen
150
dot
150
identifier
init
150
lparen
150
identifier
n
150
dot
150
identifier
get_outList
150
lparen
150
rparen
150
rparen
150
comma
152
identifier
curr_Node
152
colon
152
type
Node
152
larrow
152
identifier
out_iter
152
dot
152
identifier
step
152
lparen
152
rparen
154
in
154
lbrace
156
while
156
not
156
isvoid
156
identifier
curr_Node
156
loop
156
lbrace
158
identifier
curr_Node
158
dot
158
identifier
set_inDeg
158
lparen
158
identifier
curr_Node
158
dot
158
identifier
get_inDeg
158
lparen
158
rparen
158
minus
158
integer
1
158
rparen
158
semi
160
identifier
nEdges
160
larrow
160
identifier
nEdges
160
minus
160
integer
1
160
semi
164
if
164
identifier
curr_Node
164
dot
164
identifier
get_inDeg
164
lparen
164
rparen
164
equals
164
integer
0
164
then
166
identifier
s
166
larrow
166
identifier
s
166
dot
166
identifier
insert
166
lparen
166
identifier
curr_Node
166
rparen
168
else
168
true
168
fi
168
semi
172
identifier
curr_Node
172
larrow
172
identifier
out_iter
172
dot
172
identifier
step
172
lparen
172
rparen
172
semi
174
rbrace
174
pool
174
semi
176
rbrace
176
semi
178
identifier
n
178
larrow
178
identifier
s
178
dot
178
identifier
pop
178
lparen
178
rparen
178
semi
180
rbrace
180
pool
180
semi
182
rbrace
182
semi
186
if
186
not
186
lparen
186
identifier
nEdges
186
equals
186
integer
0
186
rparen
186
then
188
let
188
identifier
void
188
colon
188
type
List
188
in
188
lbrace
188
identifier
void
188
semi
188
rbrace
190
else
192
identifier
l
194
fi
194
semi
196
rbrace
198
rbrace
198
semi
200
rbrace
200
semi
206
type
Class
206
type
Main
206
inherits
206
type
IO
206
lbrace
210
identifier
main
210
lparen
210
rparen
210
colon
210
type
Object
210
lbrace
212
let
214
identifier
u
214
colon
214
type
Util
214
larrow
214
new
214
type
Util
214
comma
216
identifier
graph
216
colon
216
type
List
216
larrow
216
new
216
type
Nil
216
comma
218
identifier
done
218
colon
218
type
Bool
218
larrow
218
false
218
comma
220
identifier
nEdges
220
colon
220
type
Int
220
larrow
220
integer
0
220
comma
222
identifier
l
222
colon
222
type
List
224
in
224
lbrace
226
while
226
not
226
identifier
done
226
loop
226
lbrace
230
let
232
identifier
child
232
colon
232
type
String
232
larrow
232
identifier
in_string
232
lparen
232
rparen
232
comma
234
identifier
parent
234
colon
234
type
String
234
larrow
234
identifier
in_string
234
lparen
234
rparen
234
comma
236
identifier
child_inst
236
colon
236
type
Node
236
comma
238
identifier
parent_inst
238
colon
238
type
Node
240
in
240
lbrace
242
if
242
identifier
child
242
equals
242
string

242
then
244
identifier
done
244
larrow
244
true
246
else
246
lbrace
250
identifier
child_inst
250
larrow
250
identifier
u
250
dot
250
identifier
getInstance
250
lparen
250
identifier
child
250
comma
250
identifier
graph
250
rparen
250
semi
252
if
252
isvoid
252
identifier
child_inst
252
then
252
lbrace
254
identifier
child_inst
254
larrow
254
lparen
254
new
254
type
Node
254
rparen
254
dot
254
identifier
init
254
lparen
254
identifier
child
254
rparen
254
semi
256
identifier
graph
256
larrow
256
identifier
graph
256
dot
256
identifier
push
256
lparen
256
identifier
child_inst
256
rparen
256
semi
258
rbrace
260
else
260
true
260
fi
260
semi
264
identifier
parent_inst
264
larrow
264
identifier
u
264
dot
264
identifier
getInstance
264
lparen
264
identifier
parent
264
comma
264
identifier
graph
264
rparen
264
semi
266
if
266
isvoid
266
identifier
parent_inst
266
then
266
lbrace
268
identifier
parent_inst
268
larrow
268
lparen
268
new
268
type
Node
268
rparen
268
dot
268
identifier
init
268
lparen
268
identifier
parent
268
rparen
268
semi
270
identifier
graph
270
larrow
270
identifier
graph
270
dot
270
identifier
push
270
lparen
270
identifier
parent_inst
270
rparen
270
semi
272
rbrace
274
else
274
true
274
fi
274
semi
278
identifier
parent_inst
278
dot
278
identifier
set_outList
278
lparen
278
identifier
parent_inst
278
dot
278
identifier
get_outList
278
lparen
278
rparen
278
dot
278
identifier
push
278
lparen
278
identifier
child_inst
278
rparen
278
rparen
278
semi
280
identifier
child_inst
280
dot
280
identifier
set_inDeg
280
lparen
280
identifier
child_inst
280
dot
280
identifier
get_inDeg
280
lparen
280
rparen
280
plus
280
integer
1
280
rparen
280
semi
282
identifier
nEdges
282
larrow
282
identifier
nEdges
282
plus
282
integer
1
282
semi
286
rbrace
288
fi
288
semi
290
rbrace
290
semi
292
rbrace
292
pool
292
semi
296
identifier
l
296
larrow
296
identifier
u
296
dot
296
identifier
topo
296
lparen
296
identifier
graph
296
comma
296
identifier
nEdges
296
rparen
296
semi
300
if
300
isvoid
300
identifier
l
300
then
302
identifier
out_string
302
lparen
302
string
cycle\n
302
rparen
304
else
306
identifier
l
306
dot
306
identifier
print_list
306
lparen
306
rparen
308
fi
308
semi
310
rbrace
312
rbrace
312
semi
314
rbrace
314
semi
320
type
Class
320
type
List
320
inherits
320
type
IO
320
lbrace
324
identifier
insert
324
lparen
324
identifier
i
324
colon
324
type
Node
324
rparen
324
colon
324
type
List
324
lbrace
324
identifier
self
324
rbrace
324
semi
326
identifier
push
326
lparen
326
identifier
i
326
colon
326
type
Node
326
rparen
326
colon
326
type
List
326
lbrace
326
identifier
self
326
rbrace
326
semi
328
identifier
pop
328
lparen
328
rparen
328
colon
328
type
Node
328
lbrace
328
let
328
identifier
void
328
colon
328
type
Node
328
in
328
lbrace
328
identifier
void
328
semi
328
rbrace
328
rbrace
328
semi
330
identifier
get_hd
330
lparen
330
rparen
330
colon
330
type
Node
330
lbrace
330
let
330
identifier
void
330
colon
330
type
Node
330
in
330
lbrace
330
identifier
void
330
semi
330
rbrace
330
rbrace
330
semi
332
identifier
get_tl
332
lparen
332
rparen
332
colon
332
type
List
332
lbrace
332
let
332
identifier
void
332
colon
332
type
List
332
in
332
lbrace
332
identifier
void
332
semi
332
rbrace
332
rbrace
332
semi
334
identifier
print_list
334
lparen
334
rparen
334
colon
334
type
Object
334
lbrace
334
identifier
abort
334
lparen
334
rparen
334
rbrace
334
semi
338
rbrace
338
semi
342
type
Class
342
type
Cons
342
inherits
342
type
List
342
lbrace
346
identifier
hd
346
colon
346
type
Node
346
semi
348
identifier
tl
348
colon
348
type
List
348
semi
352
identifier
init
352
lparen
352
identifier
new_hd
352
colon
352
type
Node
352
comma
352
identifier
new_tl
352
colon
352
type
List
352
rparen
352
colon
352
type
Cons
352
lbrace
354
lbrace
356
identifier
hd
356
larrow
356
identifier
new_hd
356
semi
358
identifier
tl
358
larrow
358
identifier
new_tl
358
semi
360
identifier
self
360
semi
362
rbrace
364
rbrace
364
semi
368
identifier
insert
368
lparen
368
identifier
n
368
colon
368
type
Node
368
rparen
368
colon
368
type
List
368
lbrace
372
if
372
isvoid
372
identifier
hd
372
then
374
lparen
374
new
374
type
Nil
374
rparen
374
dot
374
identifier
insert
374
lparen
374
identifier
n
374
rparen
376
else
378
if
378
lparen
378
identifier
n
378
dot
378
identifier
get_label
378
lparen
378
rparen
378
lt
378
identifier
hd
378
dot
378
identifier
get_label
378
lparen
378
rparen
378
rparen
378
then
380
lparen
380
new
380
type
Cons
380
rparen
380
dot
380
identifier
init
380
lparen
380
identifier
n
380
comma
380
identifier
self
380
rparen
382
else
384
lparen
384
new
384
type
Cons
384
rparen
384
dot
384
identifier
init
384
lparen
384
identifier
hd
384
comma
384
identifier
tl
384
dot
384
identifier
insert
384
lparen
384
identifier
n
384
rparen
384
rparen
386
fi
388
fi
390
rbrace
390
semi
394
identifier
pop
394
lparen
394
rparen
394
colon
394
type
Node
394
lbrace
396
let
396
identifier
return
396
colon
396
type
Node
396
larrow
396
identifier
hd
398
in
398
lbrace
400
if
400
not
400
isvoid
400
identifier
return
400
then
400
lbrace
402
identifier
hd
402
larrow
402
identifier
tl
402
dot
402
identifier
get_hd
402
lparen
402
rparen
402
semi
404
identifier
tl
404
larrow
404
identifier
tl
404
dot
404
identifier
get_tl
404
lparen
404
rparen
404
semi
406
rbrace
408
else
408
true
408
fi
408
semi
410
identifier
return
410
semi
412
rbrace
414
rbrace
414
semi
418
identifier
push
418
lparen
418
identifier
n
418
colon
418
type
Node
418
rparen
418
colon
418
type
List
418
lbrace
420
if
420
isvoid
420
identifier
hd
420
then
422
lparen
422
new
422
type
Nil
422
rparen
422
dot
422
identifier
insert
422
lparen
422
identifier
n
422
rparen
424
else
426
if
426
isvoid
426
identifier
tl
426
dot
426
identifier
get_hd
426
lparen
426
rparen
426
then
428
lparen
428
new
428
type
Cons
428
rparen
428
dot
428
identifier
init
428
lparen
428
identifier
hd
428
comma
428
lparen
428
new
428
type
Nil
428
rparen
428
dot
428
identifier
push
428
lparen
428
identifier
n
428
rparen
428
rparen
430
else
432
lparen
432
new
432
type
Cons
432
rparen
432
dot
432
identifier
init
432
lparen
432
identifier
hd
432
comma
432
identifier
tl
432
dot
432
identifier
push
432
lparen
432
identifier
n
432
rparen
432
rparen
434
fi
436
fi
438
rbrace
438
semi
442
identifier
print_list
442
lparen
442
rparen
442
colon
442
type
Object
442
lbrace
444
lbrace
446
identifier
out_string
446
lparen
446
identifier
hd
446
dot
446
identifier
get_label
446
lparen
446
rparen
446
rparen
446
semi
448
identifier
out_string
448
lparen
448
string
\n
448
rparen
448
semi
450
identifier
tl
450
dot
450
identifier
print_list
450
lparen
450
rparen
450
semi
452
rbrace
454
rbrace
454
semi
458
identifier
get_hd
458
lparen
458
rparen
458
colon
458
type
Node
458
lbrace
458
identifier
hd
458
rbrace
458
semi
460
identifier
get_tl
460
lparen
460
rparen
460
colon
460
type
List
460
lbrace
460
identifier
tl
460
rbrace
460
semi
464
rbrace
464
semi
468
type
Class
468
type
Nil
468
inherits
468
type
List
468
lbrace
470
identifier
insert
470
lparen
470
identifier
n
470
colon
470
type
Node
470
rparen
470
colon
470
type
List
470
lbrace
470
lparen
470
new
470
type
Cons
470
rparen
470
dot
470
identifier
init
470
lparen
470
identifier
n
470
comma
470
identifier
self
470
rparen
470
rbrace
470
semi
472
identifier
push
472
lparen
472
identifier
n
472
colon
472
type
Node
472
rparen
472
colon
472
type
List
472
lbrace
472
identifier
insert
472
lparen
472
identifier
n
472
rparen
472
rbrace
472
semi
474
identifier
print_list
474
lparen
474
rparen
474
colon
474
type
Object
474
lbrace
474
true
474
rbrace
474
semi
476
rbrace
476
semi
480
type
Class
480
type
Iterator
480
lbrace
484
identifier
list
484
colon
484
type
List
484
semi
486
identifier
hd
486
colon
486
type
Node
486
semi
490
identifier
init
490
lparen
490
identifier
newList
490
colon
490
type
List
490
rparen
490
colon
490
type
Iterator
490
lbrace
492
lbrace
494
identifier
list
494
larrow
494
identifier
newList
494
semi
496
identifier
hd
496
larrow
496
identifier
newList
496
dot
496
identifier
get_hd
496
lparen
496
rparen
496
semi
498
identifier
self
498
semi
500
rbrace
502
rbrace
502
semi
506
identifier
step
506
lparen
506
rparen
506
colon
506
type
Node
506
lbrace
508
let
508
identifier
return
508
colon
508
type
Node
510
in
510
lbrace
512
if
512
not
512
isvoid
512
identifier
hd
512
then
514
lbrace
516
identifier
return
516
larrow
516
identifier
hd
516
semi
518
identifier
list
518
larrow
518
identifier
list
518
dot
518
identifier
get_tl
518
lparen
518
rparen
518
semi
520
identifier
hd
520
larrow
520
identifier
list
520
dot
520
identifier
get_hd
520
lparen
520
rparen
520
semi
522
rbrace
524
else
524
true
524
fi
524
semi
526
identifier
return
526
semi
528
rbrace
530
rbrace
530
semi
534
rbrace
534
semi
